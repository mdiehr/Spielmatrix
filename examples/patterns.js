// Glyphs example for the Spielmatrix game engine

(function(){
    // Game variables
    var w = 16, h = 16;
    var colors = [
        0x000000,
        0x656565,
        0x003300,
        0x772211,
        0xBBBBFF,
        0xDDDDFF,
        0x336699,
        0x338899,
        0xFFFFFF,
        0x99AADD,
        0xDDAA99,
        0x77BB66,
        0xAAAAAA];
    var glyphSets = [
        // Wavy pattern
        [0x86, 0x87],
        // Bricks
        [0xda, 0xda, 0xda, 0xda, 0x00, 0xff],
        // Dots
        [0x00, 0xf7, 0xf8, 0xff],
        // Cavern
        [0xcc, 0xeb, 0xff, 0xff, 0xff, 0x1c, 0x1d, 0x00, 0x00],
        // Loops
        [0x14, 0x15, 0x16, 0x17, 0x0a, 0x0b, 0x01],
        // Slopes
        [0xd0, 0xd1, 0xd2, 0xd3, 0xd4, 0xd5, 0xe0, 0xe1, 0xe2, 0xe3, 0xd7, 0xe7],
        // Chains
        [0xd9, 0x00],
        // Diagonals
        [0x1e, 0x1f],
        // Corners
        [0x10, 0x11, 0x12, 0x13],
        // Beads
        [0x8f, 0x8f, 0x00, 0x00, 0x8f, 0x8f, 0x00, 0x00, 0xff],
        // Crowds
        [0xf5, 0xf6, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xdb, 0xdc, 0xdd],
        // Horizontal Lines
        [0xa8, 0xa9, 0xaa, 0xab, 0xac, 0xad, 0xae],
        // Chess
        [ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
         0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
         0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
         0x89, 0x89, 0x89, 0x89, 0x89, 0x89, 0x89, 0x89, 
         0x8a, 0x8b, 0x8c, 0x8a, 0x8b, 0x8c,
         0x8d, 0x8e ]
    ];

    // Initialize engine
    var SM = new Spielmatrix({
        place : document.getElementById('patterns'),
        width : w,
        height : h,
        mousedown : initialize
    });

    var S = SM.selector();

    function initialize() {
        var glyphSet = selectFromList(glyphSets);
        var fg = 0, bg = 0;
        while (bg === fg) {
            fg = selectFromList(colors);
            bg = selectFromList(colors);
        }
        S().color(bg).glyphColor(fg).exec(function(tile) {
            tile.setGlyph(selectFromList(glyphSet));
        });
    }

    function selectFromList(list) {
        return list[SM.randBetween(0, list.length-1)];
    }

    initialize();

})();
